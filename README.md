# Шкала и формат взаимодействия

Vue 3 приложение: таблица с баллами 0–10 по 10 критериям, расчёт категории и запрос к AI для анализа и стратегии отношений.

## Запуск

1. Установка: `npm install`
2. **Два процесса обязательны:**
   - Терминал 1: `npm run dev` — фронт на http://localhost:5173
   - Терминал 2: `npm run api` — API на http://localhost:3001
3. Открывай приложение по адресу **http://localhost:5173**

Если API не запущен, при нажатии кнопки «Получить анализ…» будет ошибка **ECONNREFUSED** или **Failed to fetch** — запусти `npm run api` во втором терминале.

## Деплой на Vercel (фронт + API в одном проекте)

1. Залей проект в GitHub.
2. Зайди на [vercel.com](https://vercel.com) → **Add New… → Project** → выбери репозиторий.
3. **Environment Variables** (перед деплоем или после в Settings):
   - `GROQ_API_KEY` = `gsk_...` (или `OPENAI_API_KEY`)
   - `RESEND_API_KEY` = `re_...` (для кнопки «Обратная связь»)
4. **Deploy**. Vercel сам соберёт Vite-фронт и развернёт API из папки `api/`.
5. Готово: `https://cold-format-xxx.vercel.app`

**Через CLI:**
```bash
npx vercel login
npx vercel --prod
```
Переменные добавь в [vercel.com](https://vercel.com) → проект → Settings → Environment Variables → Redeploy.

## Переменные окружения

- **GROQ_API_KEY** (рекомендуется) — бесплатный ключ Groq. Регистрация: [console.groq.com/keys](https://console.groq.com/keys). Без карты, есть лимиты.
- **OPENAI_API_KEY** — ключ OpenAI (платный после исчерпания кредитов).
- **RESEND_API_KEY** — для кнопки «Обратная связь»: письма отправляются на alexey.polyakov123@gmail.com через [Resend](https://resend.com). Ключ: [resend.com/api-keys](https://resend.com/api-keys). Без ключа отправка обратной связи не работает.
- Приоритет: если задан `GROQ_API_KEY`, используется Groq; иначе — OpenAI.
- Файл **.env** в корне или **server/.env**: `GROQ_API_KEY=gsk_...`, `OPENAI_API_KEY=sk_...`, `RESEND_API_KEY=re_...`. После изменения перезапусти API.

## Логика

- 10 критериев из шкалы (Верность, Адекватность, Уют, Скромность, Интеллект, Внешность, Секс, Уважение, Ценности, Конфликтоустойчивость).
- Сумма и категория: 90–100 Единорог, 80–89 Высшая лига, 70–79 Золотая середина, 60–69 Рабочий вариант, 51–59 Зона риска, ≤50 Непригодна.
- Штраф: если Верность (п.1) или Пригодность к быту (п.3) < 4 → итог «Непригодна».
- Красные флаги: п.1 или п.8 ≤ 3. Дисбаланс: Внешность 9–10 и Адекватность 2–3. Золотой стандарт: 75+ и нет пункта ниже 6.
