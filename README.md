# Шкала и формат взаимодействия

Vue 3 приложение: таблица с баллами 0–10 по 10 критериям, расчёт категории и запрос к AI для анализа и стратегии отношений.

## Запуск

1. Установка: `npm install`
2. **Два процесса обязательны:**
   - Терминал 1: `npm run dev` — фронт на http://localhost:5173
   - Терминал 2: `npm run api` — API на http://localhost:3001
3. Открывай приложение по адресу **http://localhost:5173**

Если API не запущен, при нажатии кнопки «Получить анализ…» будет ошибка **ECONNREFUSED** или **Failed to fetch** — запусти `npm run api` во втором терминале.

## Деплой фронта (Vercel)

### Вариант A: через сайт Vercel

1. Залей проект в GitHub (если ещё не залит).
2. Зайди на [vercel.com](https://vercel.com), войди через GitHub.
3. **Add New… → Project** → выбери репозиторий → **Deploy** (Vercel подхватит Vite: `npm run build`, папка `dist`).
4. В проекте: **Settings → Environment Variables** → добавь **VITE_API_URL** = `https://твой-api.com` (если API задеплоен отдельно). Сохрани и сделай **Redeploy**.

### Вариант B: через CLI

1. Установи и войди: `npx vercel login` (откроется браузер для входа).
2. В корне проекта: `npx vercel` — превью-деплой, или `npx vercel --prod` — продакшен.
3. Переменные окружения: в [vercel.com](https://vercel.com) → твой проект → **Settings → Environment Variables** добавь **VITE_API_URL** и сделай **Redeploy**.

Готовый адрес вида `https://cold-format-xxx.vercel.app` укажи в **WEB_APP_URL** в боте для кнопки «Открыть приложение» в Telegram.

## Переменные окружения

- **GROQ_API_KEY** (рекомендуется) — бесплатный ключ Groq. Регистрация: [console.groq.com/keys](https://console.groq.com/keys). Без карты, есть лимиты.
- **OPENAI_API_KEY** — ключ OpenAI (платный после исчерпания кредитов).
- Приоритет: если задан `GROQ_API_KEY`, используется Groq; иначе — OpenAI.
- Файл **.env** в корне или **server/.env**: `GROQ_API_KEY=gsk_...` или `OPENAI_API_KEY=sk_...`. После изменения перезапусти API.

## Логика

- 10 критериев из шкалы (Верность, Адекватность, Уют, Скромность, Интеллект, Внешность, Секс, Уважение, Ценности, Конфликтоустойчивость).
- Сумма и категория: 90–100 Единорог, 80–89 Высшая лига, 70–79 Золотая середина, 60–69 Рабочий вариант, 51–59 Зона риска, ≤50 Непригодна.
- Штраф: если Верность (п.1) или Пригодность к быту (п.3) < 4 → итог «Непригодна».
- Красные флаги: п.1 или п.8 ≤ 3. Дисбаланс: Внешность 9–10 и Адекватность 2–3. Золотой стандарт: 75+ и нет пункта ниже 6.
